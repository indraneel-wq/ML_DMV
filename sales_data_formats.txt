import pandas as pd

# Load data from different formats
df_csv = pd.read_csv("sales_data.csv")
df_excel = pd.read_excel("sales_data.xlsx")
df_json = pd.read_json("sales_data.json")

print("CSV Data Loaded")
print("Excel Data Loaded")
print("JSON Data Loaded")

print("\n--- CSV Data Info ---")
print(df_csv.info())
print(df_csv.head())

print("\n--- Excel Data Info ---")
print(df_excel.info())
print(df_excel.head())

print("\n--- JSON Data Info ---")
print(df_json.info())
print(df_json.head())


print("\nMissing Values in CSV:\n", df_csv.isnull().sum())
print("\nMissing Values in Excel:\n", df_excel.isnull().sum())
print("\nMissing Values in JSON:\n", df_json.isnull().sum())

print("\nDuplicates in CSV:", df_csv.duplicated().sum())
print("Duplicates in Excel:", df_excel.duplicated().sum())
print("Duplicates in JSON:", df_json.duplicated().sum())


# Removing duplicates
df_csv = df_csv.drop_duplicates()
df_excel = df_excel.drop_duplicates()
df_json = df_json.drop_duplicates()

# Handling missing values (example: fill with 0)
df_csv = df_csv.fillna(0)
df_excel = df_excel.fillna(0)
df_json = df_json.fillna(0)

print("✅ Data cleaned successfully!")


# Combine all datasets into one dataframe
sales_data = pd.concat([df_csv, df_excel, df_json], ignore_index=True)

print("\nUnified Sales Data:")
print(sales_data.head())

sales_data.to_csv("Unified_Sales_Data.csv", index=False)
print("\n✅ Data successfully merged & saved as 'Unified_Sales_Data.csv'")

if 'Revenue' in sales_data.columns:
    print("\nTotal Revenue:", sales_data['Revenue'].sum())

if 'Product' in sales_data.columns:
    print("\nTop 5 Products by Count:")
    print(sales_data['Product'].value_counts().head())


